#!/bin/bash

# 1. Check for the --no-clear argument
DO_CLEAR=true
for arg in "$@"; do
    if [ "$arg" == "--no-clear" ]; then
        DO_CLEAR=false
    fi
done

SCRIPT_DIR=$(cd -- "$(dirname -- "${BASH_SOURCE[0]}")" &> /dev/null && pwd)
echo "get gubbyed"

# 2. Robust Directory Navigation
# Checks if the folders exist before trying to enter them
if [ -d "$HOME/gubby/aiw/scripts" ]; then
    cd "$HOME/gubby/aiw/scripts" || exit
    if [ -x "./aiwrpi.sh" ]; then
        ./aiwrpi.sh
    else
        echo "Warning: aiwrpi.sh not found or not executable."
    fi
else
    echo "Error: Directory ~/gubby/aiw/scripts not found."
fi

# 3. Pi-hole updates
sudo pihole -up
sudo pihole -g
sudo pihole -r

# 4. Fastfetch and Sleep
fastfetch
sleep 10
# 5. Conditional Clear

if [ "$DO_CLEAR" = true ]; then
    clear
fi
cd "$SCRIPT_DIR" || exit
if [ -f "gubby_art.txt" ]; then
    cat "gubby_art.txt"
else
    echo "Art file missing."
fi
apt moo
